<form [formGroup]="hashtagForm">
    <mat-form-field appearance="fill">
        <mat-label>Hashtags</mat-label>
        <mat-chip-grid #chipGrid aria-label="Hashtag selection">
            <mat-chip-row
                *ngFor="let hashtag of hashtags"
                (removed)="remove(hashtag)"
                [editable]="true"
                (edited)="edit(hashtag, $event)">
                {{ hashtag }}
                <button matChipRemove [attr.aria-label]="'remove ' + hashtag">
                    <mat-icon>close</mat-icon>
                </button>
            </mat-chip-row>
            <input
                matInput
                type="text"
                placeholder="Nowy hashtag"
                #hashtagInput
                formControlName="hashtagCtrl"
                [matChipInputFor]="chipGrid"
                [matAutocomplete]="auto"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                (matChipInputTokenEnd)="addHashtag($event)" />
        </mat-chip-grid> </mat-form-field
    ><mat-error
        *ngIf="
            hashtagForm.controls.hashtagCtrl.errors &&
            hashtagForm.controls.hashtagCtrl.errors['maxlength']
        ">
        Maksymalna ilość znaków to
        {{
            hashtagForm.controls.hashtagCtrl.errors['maxlength'][
                'requiredLength'
            ]
        }}</mat-error
    >

    <mat-autocomplete
        #auto="matAutocomplete"
        (optionSelected)="selected($event)">
        <ng-container
            *ngIf="
                hashtagForm.controls.hashtagCtrl.value.length > 1 &&
                (filteredHashtags$ | async) as filteredHashtags
            ">
            <mat-option
                *ngFor="let hashtag of filteredHashtags | slice : 0 : 5"
                [value]="hashtag"
                [innerHTML]="
                    hashtag | highlight : hashtagForm.controls.hashtagCtrl.value
                "
                >{{ hashtag }}
            </mat-option></ng-container
        >
    </mat-autocomplete>
</form>
